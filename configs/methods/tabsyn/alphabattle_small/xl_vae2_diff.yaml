config_factory: [start, datasets/alphabattle_small/alphabattle_small, methods/tabsyn/base]

# setting up the optimal autoencoder
model:
  autoencoder:
    params:
      d_token: 72
      num_layers: 2
      n_head: 1
      factor: 3
    checkpoint: /workspace/transactionsv2/transaction-generation/log/generation/alphabattle_small/ready/vae2_diff/ckpt/alpha_diff_vae.ckpt
  
  latent_encoder:
    params:
      base_factor: 512 # unetXL

  params:
    ema:
      beta: 0.999
      update_after_step: 3000
      update_every: 10

data_conf:
  train_resamples: 10
  val_ratio: 0.15
  train_transforms:
    '1':
      TimeToDiff:
        disable: false
  val_transforms:
    '1':
      TimeToDiff:
        disable: false

optimizer:
  name: AdamW
  params:
    lr: 5.e-4
    weight_decay: 1.e-9

schedulers:
  "step":
    StepLR:
      step_size: 10
      gamma: 0.2

evaluator:
  devices: ["cuda:0", "cuda:0", "cuda:0"]
  metrics:
    - OTD
    - OTD: {f1_average: micro}
    - OTD: {focus_on: [amnt]}
    - OTD: {focus_on: [hours_since_first_tx]}
    - OTD: {focus_on: [mcc_category]}
    - OTD: {focus_on: [mcc_category], f1_average: micro}
    - OTD: {max_shift: 0, focus_on: [amnt]}
    - OTD: {max_shift: 0, focus_on: [hours_since_first_tx]}
    - OTD: {max_shift: 0, focus_on: [mcc_category]}
    - OTD: {max_shift: 0, focus_on: [mcc_category], f1_average: micro}
    - Cardinality
    - OTD: {global_denom: False}
    - OTD: {focus_on: [amnt], global_denom: False}
    - OTD: {focus_on: [hours_since_first_tx], global_denom: False}
    - Detection:
        report_std: True
        condition_len: ${data_conf.generation_len}
