data_conf:
  train_random_end: time
  train_transforms:
    "3":
      CutTargetSequence:
        target_len: ${data_conf.generation_len}

# MODEL
model:
  name: OneShotGenerator
  autoencoder:
    name: BaselineAE
    params:
      cat_emb_dim: 32
      num_emb_dim: 32
      num_norm: True
      use_time: True
    pretrain: False
    frozen: False
    checkpoint:

  latent_encoder:
    name: GRU
    params:
      hidden_size: 256
      num_layers: 4
  pooler: "last"


optimizer:
  name: Adam
  params:
    lr: 1.5e-3
    weight_decay: 1.e-9

schedulers:
  "step":
    StepLR:
      step_size: 30


optuna:
  params:
    n_trials: 100
    n_startup_trials: 10
    request_list: []
    target_metric: ${trainer.ckpt_track_metric}
  suggestions:
    - ["optimizer.params.weight_decay", ["suggest_float", {low: 1.e-15, high: 1.e-2, log: True}]]
    - ["optimizer.params.lr", ["suggest_float", {low: 1.e-5, high: 0.1, log: True}]]

    - ["model.latent_encoder.params.hidden_size", ["suggest_int", {low: 10, high: 1200, log: True}]]
    - ["model.latent_encoder.params.num_layers", ["suggest_int", {low: 1, high: 10, log: False}]]
    - ["model.latent_encoder.params.dropout", ["suggest_float", {low: 1.e-10, high: 0.3, log: True}]]
    - ["model.pooler", ["suggest_categorical", {choices: ["last", "mean"]}]]

    - 
      - ["data_conf.train_transforms.1.TimeToDiff.disable", "data_conf.val_transforms.1.TimeToDiff.disable"]
      - ["suggest_categorical", {choices: [True, False]}]

    - ["model.autoencoder.params.num_norm", ["suggest_categorical", {choices: [True, False]}]]
    - ["model.autoencoder.params.cat_emb_dim", ["suggest_int", {low: 1, high: 128, log: False}]]
    - ["model.autoencoder.params.num_emb_dim", ["suggest_int", {low: 1, high: 128, log: False}]]
